{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\paska\\\\Documents\\\\FERI_2\\\\2semester\\\\RazvojAI\\\\Vaja3\\\\rain_v4_sample\\\\sp_v4_sample\\\\frontend\\\\src\\\\components\\\\PhotoDetail.js\",\n  _s = $RefreshSig$();\nimport { useState, useEffect, useContext } from 'react';\nimport { useParams } from 'react-router-dom';\nimport { UserContext } from '../userContext'; // Prepričaj se, da obstaja\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction PhotoDetail() {\n  _s();\n  var _photo$postedBy;\n  const {\n    id\n  } = useParams();\n  const [photo, setPhoto] = useState(null);\n  const [comment, setComment] = useState('');\n  const [comments, setComments] = useState([]);\n  const {\n    user\n  } = useContext(UserContext);\n  useEffect(() => {\n    const fetchPhoto = async () => {\n      const res = await fetch(`http://localhost:3001/photos/${id}`);\n      const data = await res.json();\n      setPhoto(data);\n    };\n    fetchPhoto();\n  }, [id]);\n  useEffect(() => {\n    // Pridobi komentarje za dano sliko\n    const fetchComments = async () => {\n      const res = await fetch(`http://localhost:3001/photos/${id}/comments`);\n      const data = await res.json();\n      setComments(data);\n    };\n    fetchComments();\n  }, [id]);\n  const handleCommentSubmit = async e => {\n    e.preventDefault();\n    if (!comment) return;\n    const res = await fetch(`http://localhost:3001/photos/${id}/comments`, {\n      method: 'POST',\n      credentials: 'include',\n      // če uporabljate seje/cookie\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        comment\n      })\n    });\n    if (res.ok) {\n      const data = await res.json();\n      // Posodobi lokalni seznam komentarjev, če endpoint vrne nov komentar\n      setComments(prev => [...prev, data]);\n      setComment('');\n    }\n  };\n  const handleVote = async voteType => {\n    const res = await fetch(`http://localhost:3001/photos/${id}/vote`, {\n      method: 'POST',\n      credentials: 'include',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        voteType\n      })\n    });\n    if (res.ok) {\n      const updatedPhoto = await res.json();\n      setPhoto(updatedPhoto); // Posodobi podatke o sliki\n    }\n  };\n  if (!photo) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: \"Nalaganje...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 66,\n      columnNumber: 16\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"photo-detail\",\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: photo.name\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"img\", {\n      src: \"http://localhost:3001/\" + photo.path,\n      alt: photo.name,\n      className: \"photo-detail-img\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      children: photo.description\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      className: \"text-muted\",\n      children: [\"Avtor: \", ((_photo$postedBy = photo.postedBy) === null || _photo$postedBy === void 0 ? void 0 : _photo$postedBy.username) || \"Neznan\", \" | Objavljeno: \", photo.createdAt ? new Date(photo.createdAt).toLocaleString() : \"Ni podatka\"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"comments-section\",\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        children: \"Komentarji\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 17\n      }, this), comments.length > 0 ? /*#__PURE__*/_jsxDEV(\"ul\", {\n        children: comments.map((c, index) => {\n          var _c$commentedBy;\n          return /*#__PURE__*/_jsxDEV(\"li\", {\n            children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n              children: [((_c$commentedBy = c.commentedBy) === null || _c$commentedBy === void 0 ? void 0 : _c$commentedBy.username) || \"Neznan\", \":\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 88,\n              columnNumber: 33\n            }, this), \" \", c.text]\n          }, index, true, {\n            fileName: _jsxFileName,\n            lineNumber: 87,\n            columnNumber: 29\n          }, this);\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 85,\n        columnNumber: 21\n      }, this) : /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"Ni komentarjev.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 21\n      }, this), user ? /*#__PURE__*/_jsxDEV(\"form\", {\n        onSubmit: handleCommentSubmit,\n        children: [/*#__PURE__*/_jsxDEV(\"textarea\", {\n          value: comment,\n          onChange: e => setComment(e.target.value),\n          placeholder: \"Dodaj komentar...\",\n          className: \"comment-input\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 97,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"submit\",\n          className: \"comment-button\",\n          children: \"Objavi komentar\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 103,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 21\n      }, this) : /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"Prijavite se, da komentirate.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 106,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 69,\n    columnNumber: 9\n  }, this);\n}\n_s(PhotoDetail, \"veFxECSQOyf+lVMKroqCDe+pURA=\", false, function () {\n  return [useParams];\n});\n_c = PhotoDetail;\nexport default PhotoDetail;\nvar _c;\n$RefreshReg$(_c, \"PhotoDetail\");","map":{"version":3,"names":["useState","useEffect","useContext","useParams","UserContext","jsxDEV","_jsxDEV","PhotoDetail","_s","_photo$postedBy","id","photo","setPhoto","comment","setComment","comments","setComments","user","fetchPhoto","res","fetch","data","json","fetchComments","handleCommentSubmit","e","preventDefault","method","credentials","headers","body","JSON","stringify","ok","prev","handleVote","voteType","updatedPhoto","children","fileName","_jsxFileName","lineNumber","columnNumber","className","name","src","path","alt","description","postedBy","username","createdAt","Date","toLocaleString","length","map","c","index","_c$commentedBy","commentedBy","text","onSubmit","value","onChange","target","placeholder","type","_c","$RefreshReg$"],"sources":["C:/Users/paska/Documents/FERI_2/2semester/RazvojAI/Vaja3/rain_v4_sample/sp_v4_sample/frontend/src/components/PhotoDetail.js"],"sourcesContent":["import { useState, useEffect, useContext } from 'react';\r\nimport { useParams } from 'react-router-dom';\r\nimport { UserContext } from '../userContext'; // Prepričaj se, da obstaja\r\n\r\nfunction PhotoDetail() {\r\n    const { id } = useParams();\r\n    const [photo, setPhoto] = useState(null);\r\n    const [comment, setComment] = useState('');\r\n    const [comments, setComments] = useState([]);\r\n    const { user } = useContext(UserContext);\r\n\r\n    useEffect(() => {\r\n        const fetchPhoto = async () => {\r\n            const res = await fetch(`http://localhost:3001/photos/${id}`);\r\n            const data = await res.json();\r\n            setPhoto(data);\r\n        };\r\n\r\n        fetchPhoto();\r\n    }, [id]);\r\n\r\n    useEffect(() => {\r\n        // Pridobi komentarje za dano sliko\r\n        const fetchComments = async () => {\r\n            const res = await fetch(`http://localhost:3001/photos/${id}/comments`);\r\n            const data = await res.json();\r\n            setComments(data);\r\n        };\r\n\r\n        fetchComments();\r\n    }, [id]);\r\n\r\n    const handleCommentSubmit = async (e) => {\r\n        e.preventDefault();\r\n        if (!comment) return;\r\n        const res = await fetch(`http://localhost:3001/photos/${id}/comments`, {\r\n            method: 'POST',\r\n            credentials: 'include', // če uporabljate seje/cookie\r\n            headers: {\r\n                'Content-Type': 'application/json'\r\n            },\r\n            body: JSON.stringify({ comment })\r\n        });\r\n        if (res.ok) {\r\n            const data = await res.json();\r\n            // Posodobi lokalni seznam komentarjev, če endpoint vrne nov komentar\r\n            setComments(prev => [...prev, data]);\r\n            setComment('');\r\n        }\r\n    };\r\n\r\n    const handleVote = async (voteType) => {\r\n        const res = await fetch(`http://localhost:3001/photos/${id}/vote`, {\r\n            method: 'POST',\r\n            credentials: 'include',\r\n            headers: { 'Content-Type': 'application/json' },\r\n            body: JSON.stringify({ voteType })\r\n        });\r\n        if (res.ok) {\r\n            const updatedPhoto = await res.json();\r\n            setPhoto(updatedPhoto); // Posodobi podatke o sliki\r\n        }\r\n    };\r\n\r\n    if (!photo) {\r\n        return <div>Nalaganje...</div>;\r\n    }\r\n    return (\r\n        <div className=\"photo-detail\">\r\n            <h2>{photo.name}</h2>\r\n            <img \r\n                src={\"http://localhost:3001/\" + photo.path} \r\n                alt={photo.name} \r\n                className=\"photo-detail-img\"\r\n            />\r\n            <p>{photo.description}</p>\r\n            <p className=\"text-muted\">\r\n                Avtor: {photo.postedBy?.username || \"Neznan\"} | Objavljeno: {photo.createdAt ? new Date(photo.createdAt).toLocaleString() : \"Ni podatka\"}\r\n            </p>\r\n    \r\n            {/* Oddelek za komentarje */}\r\n            <div className=\"comments-section\">\r\n                <h3>Komentarji</h3>\r\n                {comments.length > 0 ? (\r\n                    <ul>\r\n                        {comments.map((c, index) => (\r\n                            <li key={index}>\r\n                                <strong>{c.commentedBy?.username || \"Neznan\"}:</strong> {c.text}\r\n                            </li>\r\n                        ))}\r\n                    </ul>\r\n                ) : (\r\n                    <p>Ni komentarjev.</p>\r\n                )}\r\n                {user ? (\r\n                    <form onSubmit={handleCommentSubmit}>\r\n                        <textarea \r\n                            value={comment}\r\n                            onChange={(e) => setComment(e.target.value)}\r\n                            placeholder=\"Dodaj komentar...\"\r\n                            className=\"comment-input\"\r\n                        />\r\n                        <button type=\"submit\" className=\"comment-button\">Objavi komentar</button>\r\n                    </form>\r\n                ) : (\r\n                    <p>Prijavite se, da komentirate.</p>\r\n                )}\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default PhotoDetail;"],"mappings":";;AAAA,SAASA,QAAQ,EAAEC,SAAS,EAAEC,UAAU,QAAQ,OAAO;AACvD,SAASC,SAAS,QAAQ,kBAAkB;AAC5C,SAASC,WAAW,QAAQ,gBAAgB,CAAC,CAAC;AAAA,SAAAC,MAAA,IAAAC,OAAA;AAE9C,SAASC,WAAWA,CAAA,EAAG;EAAAC,EAAA;EAAA,IAAAC,eAAA;EACnB,MAAM;IAAEC;EAAG,CAAC,GAAGP,SAAS,CAAC,CAAC;EAC1B,MAAM,CAACQ,KAAK,EAAEC,QAAQ,CAAC,GAAGZ,QAAQ,CAAC,IAAI,CAAC;EACxC,MAAM,CAACa,OAAO,EAAEC,UAAU,CAAC,GAAGd,QAAQ,CAAC,EAAE,CAAC;EAC1C,MAAM,CAACe,QAAQ,EAAEC,WAAW,CAAC,GAAGhB,QAAQ,CAAC,EAAE,CAAC;EAC5C,MAAM;IAAEiB;EAAK,CAAC,GAAGf,UAAU,CAACE,WAAW,CAAC;EAExCH,SAAS,CAAC,MAAM;IACZ,MAAMiB,UAAU,GAAG,MAAAA,CAAA,KAAY;MAC3B,MAAMC,GAAG,GAAG,MAAMC,KAAK,CAAC,gCAAgCV,EAAE,EAAE,CAAC;MAC7D,MAAMW,IAAI,GAAG,MAAMF,GAAG,CAACG,IAAI,CAAC,CAAC;MAC7BV,QAAQ,CAACS,IAAI,CAAC;IAClB,CAAC;IAEDH,UAAU,CAAC,CAAC;EAChB,CAAC,EAAE,CAACR,EAAE,CAAC,CAAC;EAERT,SAAS,CAAC,MAAM;IACZ;IACA,MAAMsB,aAAa,GAAG,MAAAA,CAAA,KAAY;MAC9B,MAAMJ,GAAG,GAAG,MAAMC,KAAK,CAAC,gCAAgCV,EAAE,WAAW,CAAC;MACtE,MAAMW,IAAI,GAAG,MAAMF,GAAG,CAACG,IAAI,CAAC,CAAC;MAC7BN,WAAW,CAACK,IAAI,CAAC;IACrB,CAAC;IAEDE,aAAa,CAAC,CAAC;EACnB,CAAC,EAAE,CAACb,EAAE,CAAC,CAAC;EAER,MAAMc,mBAAmB,GAAG,MAAOC,CAAC,IAAK;IACrCA,CAAC,CAACC,cAAc,CAAC,CAAC;IAClB,IAAI,CAACb,OAAO,EAAE;IACd,MAAMM,GAAG,GAAG,MAAMC,KAAK,CAAC,gCAAgCV,EAAE,WAAW,EAAE;MACnEiB,MAAM,EAAE,MAAM;MACdC,WAAW,EAAE,SAAS;MAAE;MACxBC,OAAO,EAAE;QACL,cAAc,EAAE;MACpB,CAAC;MACDC,IAAI,EAAEC,IAAI,CAACC,SAAS,CAAC;QAAEnB;MAAQ,CAAC;IACpC,CAAC,CAAC;IACF,IAAIM,GAAG,CAACc,EAAE,EAAE;MACR,MAAMZ,IAAI,GAAG,MAAMF,GAAG,CAACG,IAAI,CAAC,CAAC;MAC7B;MACAN,WAAW,CAACkB,IAAI,IAAI,CAAC,GAAGA,IAAI,EAAEb,IAAI,CAAC,CAAC;MACpCP,UAAU,CAAC,EAAE,CAAC;IAClB;EACJ,CAAC;EAED,MAAMqB,UAAU,GAAG,MAAOC,QAAQ,IAAK;IACnC,MAAMjB,GAAG,GAAG,MAAMC,KAAK,CAAC,gCAAgCV,EAAE,OAAO,EAAE;MAC/DiB,MAAM,EAAE,MAAM;MACdC,WAAW,EAAE,SAAS;MACtBC,OAAO,EAAE;QAAE,cAAc,EAAE;MAAmB,CAAC;MAC/CC,IAAI,EAAEC,IAAI,CAACC,SAAS,CAAC;QAAEI;MAAS,CAAC;IACrC,CAAC,CAAC;IACF,IAAIjB,GAAG,CAACc,EAAE,EAAE;MACR,MAAMI,YAAY,GAAG,MAAMlB,GAAG,CAACG,IAAI,CAAC,CAAC;MACrCV,QAAQ,CAACyB,YAAY,CAAC,CAAC,CAAC;IAC5B;EACJ,CAAC;EAED,IAAI,CAAC1B,KAAK,EAAE;IACR,oBAAOL,OAAA;MAAAgC,QAAA,EAAK;IAAY;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAK,CAAC;EAClC;EACA,oBACIpC,OAAA;IAAKqC,SAAS,EAAC,cAAc;IAAAL,QAAA,gBACzBhC,OAAA;MAAAgC,QAAA,EAAK3B,KAAK,CAACiC;IAAI;MAAAL,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAK,CAAC,eACrBpC,OAAA;MACIuC,GAAG,EAAE,wBAAwB,GAAGlC,KAAK,CAACmC,IAAK;MAC3CC,GAAG,EAAEpC,KAAK,CAACiC,IAAK;MAChBD,SAAS,EAAC;IAAkB;MAAAJ,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAC/B,CAAC,eACFpC,OAAA;MAAAgC,QAAA,EAAI3B,KAAK,CAACqC;IAAW;MAAAT,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAI,CAAC,eAC1BpC,OAAA;MAAGqC,SAAS,EAAC,YAAY;MAAAL,QAAA,GAAC,SACf,EAAC,EAAA7B,eAAA,GAAAE,KAAK,CAACsC,QAAQ,cAAAxC,eAAA,uBAAdA,eAAA,CAAgByC,QAAQ,KAAI,QAAQ,EAAC,iBAAe,EAACvC,KAAK,CAACwC,SAAS,GAAG,IAAIC,IAAI,CAACzC,KAAK,CAACwC,SAAS,CAAC,CAACE,cAAc,CAAC,CAAC,GAAG,YAAY;IAAA;MAAAd,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACzI,CAAC,eAGJpC,OAAA;MAAKqC,SAAS,EAAC,kBAAkB;MAAAL,QAAA,gBAC7BhC,OAAA;QAAAgC,QAAA,EAAI;MAAU;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAI,CAAC,EAClB3B,QAAQ,CAACuC,MAAM,GAAG,CAAC,gBAChBhD,OAAA;QAAAgC,QAAA,EACKvB,QAAQ,CAACwC,GAAG,CAAC,CAACC,CAAC,EAAEC,KAAK;UAAA,IAAAC,cAAA;UAAA,oBACnBpD,OAAA;YAAAgC,QAAA,gBACIhC,OAAA;cAAAgC,QAAA,GAAS,EAAAoB,cAAA,GAAAF,CAAC,CAACG,WAAW,cAAAD,cAAA,uBAAbA,cAAA,CAAeR,QAAQ,KAAI,QAAQ,EAAC,GAAC;YAAA;cAAAX,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAQ,CAAC,KAAC,EAACc,CAAC,CAACI,IAAI;UAAA,GAD1DH,KAAK;YAAAlB,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAEV,CAAC;QAAA,CACR;MAAC;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACF,CAAC,gBAELpC,OAAA;QAAAgC,QAAA,EAAG;MAAe;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAG,CACxB,EACAzB,IAAI,gBACDX,OAAA;QAAMuD,QAAQ,EAAErC,mBAAoB;QAAAc,QAAA,gBAChChC,OAAA;UACIwD,KAAK,EAAEjD,OAAQ;UACfkD,QAAQ,EAAGtC,CAAC,IAAKX,UAAU,CAACW,CAAC,CAACuC,MAAM,CAACF,KAAK,CAAE;UAC5CG,WAAW,EAAC,mBAAmB;UAC/BtB,SAAS,EAAC;QAAe;UAAAJ,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAC5B,CAAC,eACFpC,OAAA;UAAQ4D,IAAI,EAAC,QAAQ;UAACvB,SAAS,EAAC,gBAAgB;UAAAL,QAAA,EAAC;QAAe;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAQ,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACvE,CAAC,gBAEPpC,OAAA;QAAAgC,QAAA,EAAG;MAA6B;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAG,CACtC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACA,CAAC;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACL,CAAC;AAEd;AAAClC,EAAA,CA1GQD,WAAW;EAAA,QACDJ,SAAS;AAAA;AAAAgE,EAAA,GADnB5D,WAAW;AA4GpB,eAAeA,WAAW;AAAC,IAAA4D,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}